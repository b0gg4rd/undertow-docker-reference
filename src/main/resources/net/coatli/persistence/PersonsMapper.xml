<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.coatli.persistence.PersonsMapper">

  <resultMap id="retrieveResultMap" type="Person">
    <result property="key"      javaType="string"  column="id"       jdbcType="VARCHAR" />
    <result property="name"     javaType="string"  column="name"     jdbcType="VARCHAR" />
    <result property="birthday" javaType="long"    column="birthday" jdbcType="DATE"    />
    <result property="age"      javaType="integer" column="age"      jdbcType="INTEGER" />
  </resultMap>

  <insert id="create"
          parameterType="Person">
    INSERT INTO
      persons
    (
      id,
      curp,
      names,
      first_surname,
      second_surname,
      birthday
    )
    VALUES
    (
      #{id,            mode=IN, javaType=String,  jdbcType=VARCHAR},
      #{curp,          mode=IN, javaType=String,  jdbcType=VARCHAR},
      #{names,         mode=IN, javaType=String,  jdbcType=VARCHAR},
      #{firstSurname,  mode=IN, javaType=String,  jdbcType=VARCHAR},
      #{secondSurname, mode=IN, javaType=String,  jdbcType=VARCHAR},
      #{birthday,      mode=IN, javaType=Long,    jdbcType=DATE}
    )
  </insert>

  <select id="retrieve"
          parameterType="string"
          resultMap="retrieveResultMap">
    SELECT
      id,
      name,
      birthday,
      age
    FROM
      person
    WHERE
      id = #{key, mode=IN, javaType=String, jdbcType=VARCHAR}
  </select>

  <select id="findBy"
          parameterType="FindByPersonsEvent"
          resultMap="retrieveResultMap">
    SELECT
      id,
      name,
      birthday,
      age
    FROM
      person
  </select>

</mapper>
